<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">

    <modelVersion>4.0.0</modelVersion>

    <groupId>com.browserstack</groupId>

    <artifactId>serenity-browserstack</artifactId>

    <version>0.0.1-SNAPSHOT</version>

    <packaging>jar</packaging>

    <name>Serenity BrowserStack Integration</name>

    <properties>

        <java.version>17</java.version>

        <java.source.version>${java.version}</java.source.version>

        <java.target.version>${java.version}</java.target.version>

        <maven.version>3.5.3</maven.version>

        <maven.compiler.source>17</maven.compiler.source>

        <maven.compiler.target>17</maven.compiler.target>

        <project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>

        <surefire.plugin.version>3.0.0-M5</surefire.plugin.version>

        <serenity.version>4.0.0</serenity.version>

        <serenity.maven.version>4.0.0</serenity.maven.version>

        <serenity.cucumber.version>4.0.0</serenity.cucumber.version>

        <browserstack.local.version>1.0.3</browserstack.local.version>

        <maven.failsafe-plugin.version>3.0.0-M7</maven.failsafe-plugin.version>

        <maven.surefire-plugin.version>3.0.0-M7</maven.surefire-plugin.version>

        <maven.compiler-plugin.version>3.8.1</maven.compiler-plugin.version>

        <jetty-io.version>9.4.12.v20180830</jetty-io.version>

        <jetty-util.version>9.4.12.v20180830</jetty-util.version>

    </properties>

    <repositories>

        <repository>

            <id>serenity</id>

            <name>bintray</name>

            <url>http://dl.bintray.com/serenity/maven</url>

        </repository>

    </repositories>

    <pluginRepositories>

        <pluginRepository>

            <id>serenity</id>

            <name>bintray-plugins</name>

            <url>http://dl.bintray.com/serenity/maven</url>

        </pluginRepository>

    </pluginRepositories>

    <dependencies>
        <dependency>
            <groupId>org.seleniumhq.selenium</groupId>
            <artifactId>selenium-api</artifactId>
            <version>4.5.3</version>
        </dependency>
        <dependency>
            <groupId>org.seleniumhq.selenium</groupId>
            <artifactId>selenium-chrome-driver</artifactId>
            <version>4.5.3</version>
        </dependency>
        <dependency>
            <groupId>org.seleniumhq.selenium</groupId>
            <artifactId>selenium-java</artifactId>
            <version>4.5.3</version>
        </dependency>
        <dependency>

            <groupId>net.serenity-bdd</groupId>

            <artifactId>serenity-core</artifactId>

            <version>${serenity.version}</version>

            <scope>test</scope>

        </dependency>

        <dependency>

            <groupId>net.serenity-bdd</groupId>

            <artifactId>serenity-cucumber</artifactId>

            <version>${serenity.version}</version>

            <scope>test</scope>

        </dependency>

        <dependency>

            <groupId>net.serenity-bdd</groupId>

            <artifactId>serenity-screenplay</artifactId>

            <version>${serenity.version}</version>

            <scope>test</scope>

        </dependency>

        <dependency>

            <groupId>net.serenity-bdd</groupId>

            <artifactId>serenity-screenplay-webdriver</artifactId>

            <version>${serenity.version}</version>

            <scope>test</scope>

        </dependency>

        <dependency>

            <groupId>net.serenity-bdd</groupId>

            <artifactId>serenity-ensure</artifactId>

            <version>${serenity.version}</version>

            <scope>test</scope>

        </dependency>

        <dependency>

            <groupId>org.junit.platform</groupId>

            <artifactId>junit-platform-launcher</artifactId>

            <version>1.8.1</version>

            <scope>test</scope>

        </dependency>

        <dependency>

            <groupId>org.junit.jupiter</groupId>

            <artifactId>junit-jupiter-engine</artifactId>

            <version>5.8.2</version>

            <scope>test</scope>

        </dependency>

        <dependency>

            <groupId>org.junit.vintage</groupId>

            <artifactId>junit-vintage-engine</artifactId>

            <version>5.8.2</version>

            <scope>test</scope>

        </dependency>

        <dependency>

            <groupId>ch.qos.logback</groupId>

            <artifactId>logback-classic</artifactId>

            <version>1.2.10</version>

        </dependency>

        <dependency>

            <groupId>org.assertj</groupId>

            <artifactId>assertj-core</artifactId>

            <version>3.6.2</version>

            <scope>test</scope>

        </dependency>

        <dependency>

            <groupId>com.browserstack</groupId>

            <artifactId>browserstack-local-java</artifactId>

            <version>${browserstack.local.version}</version>

        </dependency>

        <dependency>

            <groupId>com.googlecode.json-simple</groupId>

            <artifactId>json-simple</artifactId>

            <version>1.1.1</version>

        </dependency>

        <dependency>

            <groupId>org.seleniumhq.selenium</groupId>

            <artifactId>selenium-java</artifactId>

            <version>4.1.4</version>

        </dependency>

        <dependency>

            <groupId>com.browserstack</groupId>

            <artifactId>browserstack-java-sdk</artifactId>

            <version>LATEST</version>

            <scope>compile</scope>

        </dependency>

        <!-- https://mvnrepository.com/artifact/io.cucumber/cucumber-core -->
        <!-- https://mvnrepository.com/artifact/io.cucumber/cucumber-core -->
        <!-- <dependency>
            <groupId>io.cucumber</groupId>
            <artifactId>cucumber-core</artifactId>
            <version>7.3.0</version>
        </dependency> -->


    </dependencies>

    <build>

        <plugins>

            <plugin>

                <groupId>org.apache.maven.plugins</groupId>

                <artifactId>maven-surefire-plugin</artifactId>

                <version>${maven.surefire-plugin.version}</version>

                <configuration>
                    <skip>true</skip>
                    <argLine>-javaagent:"${com.browserstack:browserstack-java-sdk:jar}"</argLine>
                    <forkCount>3</forkCount>
                    <reuseForks>true</reuseForks>
                    <argLine>-Xmx1024m -XX:MaxPermSize=256m</argLine>
                </configuration>

            </plugin>

            <plugin>

                <groupId>org.apache.maven.plugins</groupId>

                <artifactId>maven-compiler-plugin</artifactId>

                <version>${maven.compiler-plugin.version}</version>

                <configuration>

                    <source>${java.version}</source>

                    <target>${java.version}</target>

                </configuration>

            </plugin>

            <plugin>

                <artifactId>maven-failsafe-plugin</artifactId>

                <version>${maven.failsafe-plugin.version}</version>

                <configuration>

                    <includes>

                        <include>com/browserstack/cucumber/Parallel*.java</include>

                    </includes>
                    <argLine>-javaagent:"${com.browserstack:browserstack-java-sdk:jar}"</argLine>

                    <parallel>classes</parallel>

                    <threadCount>3</threadCount>

                    <forkCount>3</forkCount>

                    <reuseForks>true</reuseForks>

                    <systemPropertyVariables>

                        <test_config>parallel.conf.json</test_config>

                        <test_config_environment_index>index_${surefire.forkNumber}</test_config_environment_index>

                    </systemPropertyVariables>

                </configuration>

                <executions>

                    <execution>

                        <goals>

                            <goal>integration-test</goal>

                            <goal>verify</goal>

                        </goals>

                    </execution>

                </executions>

            </plugin>

            <plugin>

                <groupId>net.serenity-bdd.maven.plugins</groupId>

                <artifactId>serenity-maven-plugin</artifactId>

                <version>${serenity.version}</version>

                <dependencies>

                    <dependency>

                        <groupId>net.serenity-bdd</groupId>

                        <artifactId>serenity-core</artifactId>

                        <version>${serenity.version}</version>

                    </dependency>

                </dependencies>

                <executions>

                    <execution>

                        <id>serenity-reports</id>

                        <phase>post-integration-test</phase>

                        <goals>

                            <goal>aggregate</goal>

                        </goals>

                    </execution>

                </executions>

            </plugin>

            <plugin>

                <artifactId>maven-dependency-plugin</artifactId>

                <version>3.3.0</version>

                <executions>

                    <execution>

                        <id>getClasspathFilenames</id>

                        <goals>

                            <goal>properties</goal>

                        </goals>

                    </execution>

                </executions>

            </plugin>

        </plugins>

    </build>

    <profiles>

        <profile>

            <id>single</id>

            <build>

                <plugins>

                    <plugin>

                        <artifactId>maven-failsafe-plugin</artifactId>

                        <version>${maven.failsafe-plugin.version}</version>

                        <configuration>

                            <includes>

                                <include>com/browserstack/cucumber/SingleTest.java</include>

                            </includes>
                            <argLine>-javaagent:"${com.browserstack:browserstack-java-sdk:jar}"</argLine>

                            <reuseForks>true</reuseForks>

                            <systemPropertyVariables>

                                <test_config>single.conf.json</test_config>

                                <test_config_environment_index>index_1</test_config_environment_index>

                            </systemPropertyVariables>

                        </configuration>

                    </plugin>

                </plugins>

            </build>

        </profile>

        <profile>

            <id>local</id>

            <build>

                <plugins>

                    <plugin>

                        <artifactId>maven-failsafe-plugin</artifactId>

                        <version>${maven.failsafe-plugin.version}</version>

                        <configuration>

                            <includes>

                                <include>com/browserstack/cucumber/LocalTest.java</include>

                            </includes>
                            <argLine>-javaagent:"${com.browserstack:browserstack-java-sdk:jar}"</argLine>

                            <reuseForks>true</reuseForks>

                            <systemPropertyVariables>

                                <test_config>local.conf.json</test_config>

                                <test_config_environment_index>index_1</test_config_environment_index>

                            </systemPropertyVariables>

                        </configuration>

                    </plugin>

                </plugins>

            </build>

        </profile>

        <profile>

            <id>parallel</id>

            <build>

                <plugins>

                    <plugin>

                        <artifactId>maven-failsafe-plugin</artifactId>

                        <version>${maven.failsafe-plugin.version}</version>

                        <configuration>

                            <includes>

                                <include>com/browserstack/cucumber/Parallel*.java</include>

                            </includes>
                            <argLine>-javaagent:"${com.browserstack:browserstack-java-sdk:jar}"</argLine>

                            <parallel>classes</parallel>

                            <threadCount>3</threadCount>

                            <forkCount>3</forkCount>

                            <reuseForks>true</reuseForks>

                            <systemPropertyVariables>

                                <test_config>parallel.conf.json</test_config>

                                <test_config_environment_index>index_${surefire.forkNumber}</test_config_environment_index>

                            </systemPropertyVariables>

                        </configuration>

                    </plugin>

                </plugins>

            </build>

        </profile>

    </profiles>

</project>
